
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Raster functions &#8212; Mosaic</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/tabs.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Usage" href="../usage/usage.html" />
    <link rel="prev" title="Spatial aggregation functions" href="spatial-aggregations.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=green data-md-color-accent=green>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#api/raster-functions" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Mosaic"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/mosaic_logo.svg" height="26"
                   alt="Mosaic logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Mosaic v0.3.9</span>
          <span class="md-header-nav__topic"> Raster functions </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/databrickslabs/mosaic/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Mosaic
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Mosaic</a></li>
          <li class="md-tabs__item"><a href="api.html" class="md-tabs__link">API Documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Mosaic" class="md-nav__button md-logo">
      
        <img src="../_static/mosaic_logo.svg" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Mosaic">Mosaic v0.3.9</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/databrickslabs/mosaic/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Mosaic
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Contents:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="api.html" class="md-nav__link">API Documentation</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="geometry-constructors.html" class="md-nav__link">Geometry constructors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="geometry-accessors.html" class="md-nav__link">Geometry accessors</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spatial-functions.html" class="md-nav__link">Spatial functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spatial-indexing.html" class="md-nav__link">Spatial grid indexing</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spatial-predicates.html" class="md-nav__link">Spatial predicates</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="spatial-aggregations.html" class="md-nav__link">Spatial aggregation functions</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Raster functions </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Raster functions</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#api-raster-functions--page-root" class="md-nav__link">Raster functions</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#intro" class="md-nav__link">Intro</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#rst-bandmetadata" class="md-nav__link">rst_bandmetadata</a>
        </li>
        <li class="md-nav__item"><a href="#rst-georeference" class="md-nav__link">rst_georeference</a>
        </li>
        <li class="md-nav__item"><a href="#rst-height" class="md-nav__link">rst_height</a>
        </li>
        <li class="md-nav__item"><a href="#rst-isempty" class="md-nav__link">rst_isempty</a>
        </li>
        <li class="md-nav__item"><a href="#rst-memsize" class="md-nav__link">rst_memsize</a>
        </li>
        <li class="md-nav__item"><a href="#rst-metadata" class="md-nav__link">rst_metadata</a>
        </li>
        <li class="md-nav__item"><a href="#rst-numbands" class="md-nav__link">rst_numbands</a>
        </li>
        <li class="md-nav__item"><a href="#rst-pixelheight" class="md-nav__link">rst_pixelheight</a>
        </li>
        <li class="md-nav__item"><a href="#rst-pixelwidth" class="md-nav__link">rst_pixelwidth</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridavg" class="md-nav__link">rst_rastertogridavg</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridcount" class="md-nav__link">rst_rastertogridcount</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridmax" class="md-nav__link">rst_rastertogridmax</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridmedian" class="md-nav__link">rst_rastertogridmedian</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridmin" class="md-nav__link">rst_rastertogridmin</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertoworldcoord" class="md-nav__link">rst_rastertoworldcoord</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertoworldcoordx" class="md-nav__link">rst_rastertoworldcoordx</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertoworldcoordy" class="md-nav__link">rst_rastertoworldcoordy</a>
        </li>
        <li class="md-nav__item"><a href="#rst-retile" class="md-nav__link">rst_retile</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rotation" class="md-nav__link">rst_rotation</a>
        </li>
        <li class="md-nav__item"><a href="#rst-scalex" class="md-nav__link">rst_scalex</a>
        </li>
        <li class="md-nav__item"><a href="#rst-scaley" class="md-nav__link">rst_scaley</a>
        </li>
        <li class="md-nav__item"><a href="#rst-skewx" class="md-nav__link">rst_skewx</a>
        </li>
        <li class="md-nav__item"><a href="#rst-skewy" class="md-nav__link">rst_skewy</a>
        </li>
        <li class="md-nav__item"><a href="#rst-srid" class="md-nav__link">rst_srid</a>
        </li>
        <li class="md-nav__item"><a href="#rst-subdatasets" class="md-nav__link">rst_subdatasets</a>
        </li>
        <li class="md-nav__item"><a href="#rst-summary" class="md-nav__link">rst_summary</a>
        </li>
        <li class="md-nav__item"><a href="#rst-upperleftx" class="md-nav__link">rst_upperleftx</a>
        </li>
        <li class="md-nav__item"><a href="#rst-upperlefty" class="md-nav__link">rst_upperlefty</a>
        </li>
        <li class="md-nav__item"><a href="#rst-width" class="md-nav__link">rst_width</a>
        </li>
        <li class="md-nav__item"><a href="#rst-worldtorastercoord" class="md-nav__link">rst_worldtorastercoord</a>
        </li>
        <li class="md-nav__item"><a href="#rst-worldtorastercoordx" class="md-nav__link">rst_worldtorastercoordx</a>
        </li>
        <li class="md-nav__item"><a href="#rst-worldtorastercoordy" class="md-nav__link">rst_worldtorastercoordy</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/api/raster-functions.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../usage/usage.html" class="md-nav__link">Usage</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../usage/installation.html" class="md-nav__link">Installation guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../usage/install-gdal.html" class="md-nav__link">GDAL Installation guide</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../usage/grid-indexes.html" class="md-nav__link">Using grid index systems in Mosaic</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../usage/grid-indexes-bng.html" class="md-nav__link">BNG - British National Grid</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../usage/quickstart.html" class="md-nav__link">Quickstart notebook</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../usage/kepler.html" class="md-nav__link">Kepler visualizations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../usage/automatic-sql-registration.html" class="md-nav__link">Automatic SQL registration</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models/models.html" class="md-nav__link">Models</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../models/spatial-knn.html" class="md-nav__link">Spatial K Nearest Neighbours</a>
      
    
    </li></ul>
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#api-raster-functions--page-root" class="md-nav__link">Raster functions</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#intro" class="md-nav__link">Intro</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#rst-bandmetadata" class="md-nav__link">rst_bandmetadata</a>
        </li>
        <li class="md-nav__item"><a href="#rst-georeference" class="md-nav__link">rst_georeference</a>
        </li>
        <li class="md-nav__item"><a href="#rst-height" class="md-nav__link">rst_height</a>
        </li>
        <li class="md-nav__item"><a href="#rst-isempty" class="md-nav__link">rst_isempty</a>
        </li>
        <li class="md-nav__item"><a href="#rst-memsize" class="md-nav__link">rst_memsize</a>
        </li>
        <li class="md-nav__item"><a href="#rst-metadata" class="md-nav__link">rst_metadata</a>
        </li>
        <li class="md-nav__item"><a href="#rst-numbands" class="md-nav__link">rst_numbands</a>
        </li>
        <li class="md-nav__item"><a href="#rst-pixelheight" class="md-nav__link">rst_pixelheight</a>
        </li>
        <li class="md-nav__item"><a href="#rst-pixelwidth" class="md-nav__link">rst_pixelwidth</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridavg" class="md-nav__link">rst_rastertogridavg</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridcount" class="md-nav__link">rst_rastertogridcount</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridmax" class="md-nav__link">rst_rastertogridmax</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridmedian" class="md-nav__link">rst_rastertogridmedian</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertogridmin" class="md-nav__link">rst_rastertogridmin</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertoworldcoord" class="md-nav__link">rst_rastertoworldcoord</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertoworldcoordx" class="md-nav__link">rst_rastertoworldcoordx</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rastertoworldcoordy" class="md-nav__link">rst_rastertoworldcoordy</a>
        </li>
        <li class="md-nav__item"><a href="#rst-retile" class="md-nav__link">rst_retile</a>
        </li>
        <li class="md-nav__item"><a href="#rst-rotation" class="md-nav__link">rst_rotation</a>
        </li>
        <li class="md-nav__item"><a href="#rst-scalex" class="md-nav__link">rst_scalex</a>
        </li>
        <li class="md-nav__item"><a href="#rst-scaley" class="md-nav__link">rst_scaley</a>
        </li>
        <li class="md-nav__item"><a href="#rst-skewx" class="md-nav__link">rst_skewx</a>
        </li>
        <li class="md-nav__item"><a href="#rst-skewy" class="md-nav__link">rst_skewy</a>
        </li>
        <li class="md-nav__item"><a href="#rst-srid" class="md-nav__link">rst_srid</a>
        </li>
        <li class="md-nav__item"><a href="#rst-subdatasets" class="md-nav__link">rst_subdatasets</a>
        </li>
        <li class="md-nav__item"><a href="#rst-summary" class="md-nav__link">rst_summary</a>
        </li>
        <li class="md-nav__item"><a href="#rst-upperleftx" class="md-nav__link">rst_upperleftx</a>
        </li>
        <li class="md-nav__item"><a href="#rst-upperlefty" class="md-nav__link">rst_upperlefty</a>
        </li>
        <li class="md-nav__item"><a href="#rst-width" class="md-nav__link">rst_width</a>
        </li>
        <li class="md-nav__item"><a href="#rst-worldtorastercoord" class="md-nav__link">rst_worldtorastercoord</a>
        </li>
        <li class="md-nav__item"><a href="#rst-worldtorastercoordx" class="md-nav__link">rst_worldtorastercoordx</a>
        </li>
        <li class="md-nav__item"><a href="#rst-worldtorastercoordy" class="md-nav__link">rst_worldtorastercoordy</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/api/raster-functions.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<h1 id="api-raster-functions--page-root">Raster functions<a class="headerlink" href="#api-raster-functions--page-root" title="Permalink to this headline">¶</a></h1>

<h2 id="intro">Intro<a class="headerlink" href="#intro" title="Permalink to this headline">¶</a></h2>
<p>Raster functions are available in mosaic if you have installed the optional dependency <cite>GDAL</cite>.
Please see <a class="reference internal" href="../usage/install-gdal.html"><span class="doc">Install and Enable GDAL with Mosaic</span></a> for installation instructions.
Mosaic provides several unique raster functions that are not available in other Spark packages.
Mainly raster to grid functions, which are useful for reprojecting the raster data into a standard grid index system.
This is useful for performing spatial joins between raster data and vector data.
Mosaic also provides a scalable retiling function that can be used to retile raster data in case of bottlenecking due to large files.
All raster functions respect the "rst_" prefix naming convention.</p>

<h3 id="rst-bandmetadata">rst_bandmetadata<a class="headerlink" href="#rst-bandmetadata" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_bandmetadata">
<span class="sig-name descname"><span class="pre">rst_bandmetadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">band</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_bandmetadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the metadata describing the raster band.
Metadata is return as a map of key value pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>band</strong> (<em>Column</em><em> (</em><em>IntegerType</em><em>)</em>) – The band number to extract metadata for.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-0-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-0-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-0-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-0-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-0-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-0-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="s2">"path"</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">)))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------+</span>
<span class="go">|rst_bandmetadata(path, 1)                                                           |</span>
<span class="go">+------------------------------------------------------------------------------------+</span>
<span class="go">|{"_FillValue": "251", "NETCDF_DIM_time": "1294315200", "long_name": "bleaching alert|</span>
<span class="go">|area 7-day maximum composite", "grid_mapping": "crs", "NETCDF_VARNAME":             |</span>
<span class="go">|"bleaching_alert_area", "coverage_content_type": "thematicClassification",          |</span>
<span class="go">|"standard_name": "N/A", "comment": "Bleaching Alert Area (BAA) values are coral     |</span>
<span class="go">|bleaching heat stress levels: 0 - No Stress; 1 - Bleaching Watch; 2 - Bleaching     |</span>
<span class="go">|Warning; 3 - Bleaching Alert Level 1; 4 - Bleaching Alert Level 2. Product          |</span>
<span class="go">|description is provided at https://coralreefwatch.noaa.gov/product/5km/index.php.", |</span>
<span class="go">|"valid_min": "0", "units": "stress_level", "valid_max": "4", "scale_factor": "1"}   |</span>
<span class="go">+------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">1</span><span class="p">)).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span><span class="p">(</span><span class="kc">false</span><span class="p">)</span>
<span class="o">+------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">rst_bandmetadata</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">                                                           </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="s">"_FillValue"</span><span class="p">:</span><span class="w"> </span><span class="s">"251"</span><span class="p">,</span><span class="w"> </span><span class="s">"NETCDF_DIM_time"</span><span class="p">:</span><span class="w"> </span><span class="s">"1294315200"</span><span class="p">,</span><span class="w"> </span><span class="s">"long_name"</span><span class="p">:</span><span class="w"> </span><span class="s">"bleaching alert|</span>
<span class="s">|area 7-day maximum composite"</span><span class="p">,</span><span class="w"> </span><span class="s">"grid_mapping"</span><span class="p">:</span><span class="w"> </span><span class="s">"crs"</span><span class="p">,</span><span class="w"> </span><span class="s">"NETCDF_VARNAME"</span><span class="p">:</span><span class="w">             </span><span class="o">|</span>
<span class="o">|</span><span class="s">"bleaching_alert_area"</span><span class="p">,</span><span class="w"> </span><span class="s">"coverage_content_type"</span><span class="p">:</span><span class="w"> </span><span class="s">"thematicClassification"</span><span class="p">,</span><span class="w">          </span><span class="o">|</span>
<span class="o">|</span><span class="s">"standard_name"</span><span class="p">:</span><span class="w"> </span><span class="s">"N/A"</span><span class="p">,</span><span class="w"> </span><span class="s">"comment"</span><span class="p">:</span><span class="w"> </span><span class="s">"Bleaching Alert Area (BAA) values are coral     |</span>
<span class="s">|bleaching heat stress levels: 0 - No Stress; 1 - Bleaching Watch; 2 - Bleaching     |</span>
<span class="s">|Warning; 3 - Bleaching Alert Level 1; 4 - Bleaching Alert Level 2. Product          |</span>
<span class="s">|description is provided at https://coralreefwatch.noaa.gov/product/5km/index.php."</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="s">"valid_min"</span><span class="p">:</span><span class="w"> </span><span class="s">"0"</span><span class="p">,</span><span class="w"> </span><span class="s">"units"</span><span class="p">:</span><span class="w"> </span><span class="s">"stress_level"</span><span class="p">,</span><span class="w"> </span><span class="s">"valid_max"</span><span class="p">:</span><span class="w"> </span><span class="s">"4"</span><span class="p">,</span><span class="w"> </span><span class="s">"scale_factor"</span><span class="p">:</span><span class="w"> </span><span class="s">"1"</span><span class="p">}</span><span class="w">   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-0-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_bandmetadata(path, 1) FROM coral_netcdf LIMIT 1
+------------------------------------------------------------------------------------+
|rst_bandmetadata(path, 1)                                                           |
+------------------------------------------------------------------------------------+
|{"_FillValue": "251", "NETCDF_DIM_time": "1294315200", "long_name": "bleaching alert|
|area 7-day maximum composite", "grid_mapping": "crs", "NETCDF_VARNAME":             |
|"bleaching_alert_area", "coverage_content_type": "thematicClassification",          |
|"standard_name": "N/A", "comment": "Bleaching Alert Area (BAA) values are coral     |
|bleaching heat stress levels: 0 - No Stress; 1 - Bleaching Watch; 2 - Bleaching     |
|Warning; 3 - Bleaching Alert Level 1; 4 - Bleaching Alert Level 2. Product          |
|description is provided at https://coralreefwatch.noaa.gov/product/5km/index.php.", |
|"valid_min": "0", "units": "stress_level", "valid_max": "4", "scale_factor": "1"}   |
+------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>


<h3 id="rst-georeference">rst_georeference<a class="headerlink" href="#rst-georeference" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_georeference">
<span class="sig-name descname"><span class="pre">rst_georeference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_georeference" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns GeoTransform of the raster as a GT array of doubles.
GT(0) x-coordinate of the upper-left corner of the upper-left pixel.
GT(1) w-e pixel resolution / pixel width.
GT(2) row rotation (typically zero).
GT(3) y-coordinate of the upper-left corner of the upper-left pixel.
GT(4) column rotation (typically zero).
GT(5) n-s pixel resolution / pixel height (negative value for a north-up image).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, DoubleType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-1-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-1-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-1-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-1-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-1-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-1-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">            .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_georeference</span><span class="p">(</span><span class="s2">"path"</span><span class="p">))</span><span class="o">.</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">display</span><span class="p">()</span>
<span class="go">+-------------------------------------------------------------------------------------------+</span>
<span class="go">|rst_georeference(path)                                                                     |</span>
<span class="go">+-------------------------------------------------------------------------------------------+</span>
<span class="go">|{"scaleY": -0.049999999152053956, "skewX": 0, "skewY": 0, "upperLeftY": 89.99999847369712, |</span>
<span class="go">|"upperLeftX": -180.00000610436345, "scaleX": 0.050000001695656514}                         |</span>
<span class="go">+-------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                        </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                        </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_georeference</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">))).</span><span class="n">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+-------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">rst_georeference</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="s">"scaleY"</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mf">0.049999999152053956</span><span class="p">,</span><span class="w"> </span><span class="s">"skewX"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">"skewY"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s">"upperLeftY"</span><span class="p">:</span><span class="w"> </span><span class="mf">89.99999847369712</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="s">"upperLeftX"</span><span class="p">:</span><span class="w"> </span><span class="o">-</span><span class="mf">180.00000610436345</span><span class="p">,</span><span class="w"> </span><span class="s">"scaleX"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.050000001695656514</span><span class="p">}</span><span class="w">                         </span><span class="o">|</span>
<span class="o">+-------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-1-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_georeference(path) FROM coral_netcdf LIMIT 1
+-------------------------------------------------------------------------------------------+
|rst_georeference(path)                                                                     |
+-------------------------------------------------------------------------------------------+
|{"scaleY": -0.049999999152053956, "skewX": 0, "skewY": 0, "upperLeftY": 89.99999847369712, |
|"upperLeftX": -180.00000610436345, "scaleX": 0.050000001695656514}                         |
+-------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>


<h3 id="rst-height">rst_height<a class="headerlink" href="#rst-height" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_height">
<span class="sig-name descname"><span class="pre">rst_height</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the height of the raster in pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-2-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-2-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-2-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-2-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-2-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-2-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_height</span><span class="p">(</span><span class="s1">'path'</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+--------------------+</span>
<span class="go">| rst_height(path)   |</span>
<span class="go">+--------------------+</span>
<span class="go">|3600                |</span>
<span class="go">|3600                |</span>
<span class="go">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_height</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-2-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">|</span><span class="mi">3600</span><span class="w">                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-isempty">rst_isempty<a class="headerlink" href="#rst-isempty" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_isempty">
<span class="sig-name descname"><span class="pre">rst_isempty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_isempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns true if the raster is empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: BooleanType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-3-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-3-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-3-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-3-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-3-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-3-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_isempty</span><span class="p">(</span><span class="s1">'path'</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+--------------------+</span>
<span class="go">| rst_height(path)   |</span>
<span class="go">+--------------------+</span>
<span class="go">|false               |</span>
<span class="go">|false               |</span>
<span class="go">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_isempty</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="kc">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="kc">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-3-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_isempty</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="k">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">|</span><span class="k">false</span><span class="w">               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-memsize">rst_memsize<a class="headerlink" href="#rst-memsize" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_memsize">
<span class="sig-name descname"><span class="pre">rst_memsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_memsize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns size of the raster in bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: LongType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-4-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-4-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-4-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-4-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-4-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-4-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_memsize</span><span class="p">(</span><span class="s1">'path'</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+--------------------+</span>
<span class="go">| rst_height(path)   |</span>
<span class="go">+--------------------+</span>
<span class="go">|730260              |</span>
<span class="go">|730260              |</span>
<span class="go">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_memsize</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+--------------------+</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">+--------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-4-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_memsize</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_height</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">|</span><span class="mi">730260</span><span class="w">              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-metadata">rst_metadata<a class="headerlink" href="#rst-metadata" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_metadata">
<span class="sig-name descname"><span class="pre">rst_metadata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_metadata" title="Permalink to this definition">¶</a></dt>
<dd><p>Extract the metadata describing the raster.
Metadata is return as a map of key value pairs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-5-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-5-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-5-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-5-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-5-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-5-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_metadata</span><span class="p">(</span><span class="s1">'path'</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_metadata(path)                                                                                               |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|{"NC_GLOBAL#publisher_url": "https://coralreefwatch.noaa.gov", "NC_GLOBAL#geospatial_lat_units": "degrees_north", |</span>
<span class="go">|"NC_GLOBAL#platform_vocabulary": "NOAA NODC Ocean Archive System Platforms", "NC_GLOBAL#creator_type": "group",   |</span>
<span class="go">|"NC_GLOBAL#geospatial_lon_units": "degrees_east", "NC_GLOBAL#geospatial_bounds": "POLYGON((-90.0 180.0, 90.0      |</span>
<span class="go">|180.0, 90.0 -180.0, -90.0 -180.0, -90.0 180.0))", "NC_GLOBAL#keywords": "Oceans &gt; Ocean Temperature &gt; Sea Surface |</span>
<span class="go">|Temperature, Oceans &gt; Ocean Temperature &gt; Water Temperature, Spectral/Engineering &gt; Infrared Wavelengths &gt; Thermal|</span>
<span class="go">|Infrared, Oceans &gt; Ocean Temperature &gt; Bleaching Alert Area", "NC_GLOBAL#geospatial_lat_max": "89.974998",        |</span>
<span class="go">|.... (truncated).... "NC_GLOBAL#history": "This is a product data file of the NOAA Coral Reef Watch Daily Global  |</span>
<span class="go">|5km Satellite Coral Bleaching Heat Stress Monitoring Product Suite Version 3.1 (v3.1) in its NetCDF Version 1.0   |</span>
<span class="go">|(v1.0).", "NC_GLOBAL#publisher_institution": "NOAA/NESDIS/STAR Coral Reef Watch Program",                         |</span>
<span class="go">|"NC_GLOBAL#cdm_data_type": "Grid"}                                                                                |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">{</span><span class="s">"NC_GLOBAL#publisher_url"</span><span class="p">:</span><span class="w"> </span><span class="s">"https://coralreefwatch.noaa.gov"</span><span class="p">,</span><span class="w"> </span><span class="s">"NC_GLOBAL#geospatial_lat_units"</span><span class="p">:</span><span class="w"> </span><span class="s">"degrees_north"</span><span class="p">,</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="s">"NC_GLOBAL#platform_vocabulary"</span><span class="p">:</span><span class="w"> </span><span class="s">"NOAA NODC Ocean Archive System Platforms"</span><span class="p">,</span><span class="w"> </span><span class="s">"NC_GLOBAL#creator_type"</span><span class="p">:</span><span class="w"> </span><span class="s">"group"</span><span class="p">,</span><span class="w">   </span><span class="o">|</span>
<span class="o">|</span><span class="s">"NC_GLOBAL#geospatial_lon_units"</span><span class="p">:</span><span class="w"> </span><span class="s">"degrees_east"</span><span class="p">,</span><span class="w"> </span><span class="s">"NC_GLOBAL#geospatial_bounds"</span><span class="p">:</span><span class="w"> </span><span class="s">"POLYGON((-90.0 180.0, 90.0      |</span>
<span class="s">|180.0, 90.0 -180.0, -90.0 -180.0, -90.0 180.0))"</span><span class="p">,</span><span class="w"> </span><span class="s">"NC_GLOBAL#keywords"</span><span class="p">:</span><span class="w"> </span><span class="s">"Oceans &gt; Ocean Temperature &gt; Sea Surface |</span>
<span class="s">|Temperature, Oceans &gt; Ocean Temperature &gt; Water Temperature, Spectral/Engineering &gt; Infrared Wavelengths &gt; Thermal|</span>
<span class="s">|Infrared, Oceans &gt; Ocean Temperature &gt; Bleaching Alert Area"</span><span class="p">,</span><span class="w"> </span><span class="s">"NC_GLOBAL#geospatial_lat_max"</span><span class="p">:</span><span class="w"> </span><span class="s">"89.974998"</span><span class="p">,</span><span class="w">        </span><span class="o">|</span>
<span class="o">|</span><span class="p">....</span><span class="w"> </span><span class="p">(</span><span class="n">truncated</span><span class="p">)....</span><span class="w"> </span><span class="s">"NC_GLOBAL#history"</span><span class="p">:</span><span class="w"> </span><span class="s">"This is a product data file of the NOAA Coral Reef Watch Daily Global  |</span>
<span class="s">|5km Satellite Coral Bleaching Heat Stress Monitoring Product Suite Version 3.1 (v3.1) in its NetCDF Version 1.0   |</span>
<span class="s">|(v1.0)."</span><span class="p">,</span><span class="w"> </span><span class="s">"NC_GLOBAL#publisher_institution"</span><span class="p">:</span><span class="w"> </span><span class="s">"NOAA/NESDIS/STAR Coral Reef Watch Program"</span><span class="p">,</span><span class="w">                         </span><span class="o">|</span>
<span class="o">|</span><span class="s">"NC_GLOBAL#cdm_data_type"</span><span class="p">:</span><span class="w"> </span><span class="s">"Grid"</span><span class="p">}</span><span class="w">                                                                                </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-5-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_metadata(path) FROM coral_netcdf LIMIT 1
+------------------------------------------------------------------------------------------------------------------+
| rst_metadata(path)                                                                                               |
+------------------------------------------------------------------------------------------------------------------+
|{"NC_GLOBAL#publisher_url": "https://coralreefwatch.noaa.gov", "NC_GLOBAL#geospatial_lat_units": "degrees_north", |
|"NC_GLOBAL#platform_vocabulary": "NOAA NODC Ocean Archive System Platforms", "NC_GLOBAL#creator_type": "group",   |
|"NC_GLOBAL#geospatial_lon_units": "degrees_east", "NC_GLOBAL#geospatial_bounds": "POLYGON((-90.0 180.0, 90.0      |
|180.0, 90.0 -180.0, -90.0 -180.0, -90.0 180.0))", "NC_GLOBAL#keywords": "Oceans &gt; Ocean Temperature &gt; Sea Surface |
|Temperature, Oceans &gt; Ocean Temperature &gt; Water Temperature, Spectral/Engineering &gt; Infrared Wavelengths &gt; Thermal|
|Infrared, Oceans &gt; Ocean Temperature &gt; Bleaching Alert Area", "NC_GLOBAL#geospatial_lat_max": "89.974998",        |
|.... (truncated).... "NC_GLOBAL#history": "This is a product data file of the NOAA Coral Reef Watch Daily Global  |
|5km Satellite Coral Bleaching Heat Stress Monitoring Product Suite Version 3.1 (v3.1) in its NetCDF Version 1.0   |
|(v1.0).", "NC_GLOBAL#publisher_institution": "NOAA/NESDIS/STAR Coral Reef Watch Program",                         |
|"NC_GLOBAL#cdm_data_type": "Grid"}                                                                                |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>


<h3 id="rst-numbands">rst_numbands<a class="headerlink" href="#rst-numbands" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_numbands">
<span class="sig-name descname"><span class="pre">rst_numbands</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_numbands" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns number of bands in the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-6-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-6-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-6-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-6-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-6-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-6-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_numbands</span><span class="p">(</span><span class="s1">'path'</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---------------------+</span>
<span class="go">| rst_numbands(path)  |</span>
<span class="go">+---------------------+</span>
<span class="go">| 1                   |</span>
<span class="go">| 1                   |</span>
<span class="go">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_numbands</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">  </span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-6-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_metadata</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_numbands</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-pixelheight">rst_pixelheight<a class="headerlink" href="#rst-pixelheight" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_pixelheight">
<span class="sig-name descname"><span class="pre">rst_pixelheight</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_pixelheight" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the height of the pixel in the raster derived via GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-7-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-7-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-7-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-7-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-7-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-7-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="s1">'path'</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---------------------+</span>
<span class="go">|rst_pixelheight(path)|</span>
<span class="go">+---------------------+</span>
<span class="go">| 1                   |</span>
<span class="go">| 1                   |</span>
<span class="go">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-7-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="n">rst_pixelheight</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-pixelwidth">rst_pixelwidth<a class="headerlink" href="#rst-pixelwidth" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_pixelwidth">
<span class="sig-name descname"><span class="pre">rst_pixelwidth</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_pixelwidth" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the width of the pixel in the raster derived via GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-8-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-8-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-8-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-8-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-8-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-8-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="s1">'path'</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+---------------------+</span>
<span class="go">| rst_pixelwidth(path)|</span>
<span class="go">+---------------------+</span>
<span class="go">| 1                   |</span>
<span class="go">| 1                   |</span>
<span class="go">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">))).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+---------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-8-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_pixelwidth</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="w">                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-rastertogridavg">rst_rastertogridavg<a class="headerlink" href="#rst-rastertogridavg" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridavg">
<span class="sig-name descname"><span class="pre">rst_rastertogridavg</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridavg" title="Permalink to this definition">¶</a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the average of the pixel values in the cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-9-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-9-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-9-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-9-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-9-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-9-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_rastertogridavg(path, 3)                                                                                     |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1.2037735849056603},|</span>
<span class="go">|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1.1283185840707965},  |</span>
<span class="go">|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593472602366803967", "measure": 0.3963963963963964},                                                  |</span>
<span class="go">|{"cellID": "593785619583336447", "measure": 0.6590909090909091}, {"cellID": "591988330388783103", "measure": 1},  |</span>
<span class="go">|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridavg</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593176490141548543"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593386771740360703"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593308294097928191"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593825202001936383"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593163914477305855"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592998781574709247"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593262526926422015"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592370479398911999"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593472602366803967"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593785619583336447"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"591988330388783103"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592336738135834623"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-9-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_rastertogridavg(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridavg(path, 3)                                                                                     |
+------------------------------------------------------------------------------------------------------------------+
|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1.2037735849056603},|
|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |
|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1.1283185840707965},  |
|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |
|{"cellID": "593472602366803967", "measure": 0.3963963963963964},                                                  |
|{"cellID": "593785619583336447", "measure": 0.6590909090909091}, {"cellID": "591988330388783103", "measure": 1},  |
|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id2">
<img alt="../_images/h3.png" src="../_images/h3.png"/>
<p class="caption"><span class="caption-text">Fig 1. RST_RasterToGridAvg(raster, 3)</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>


<h3 id="rst-rastertogridcount">rst_rastertogridcount<a class="headerlink" href="#rst-rastertogridcount" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridcount">
<span class="sig-name descname"><span class="pre">rst_rastertogridcount</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridcount" title="Permalink to this definition">¶</a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the average of the pixel values in the cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-10-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-10-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-10-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-10-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-10-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-10-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_rastertogridcount(path, 3)                                                                                   |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1},                 |</span>
<span class="go">|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1},                   |</span>
<span class="go">|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593472602366803967", "measure": 3},                                                                   |</span>
<span class="go">|{"cellID": "593785619583336447", "measure": 3}, {"cellID": "591988330388783103", "measure": 1},                   |</span>
<span class="go">|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridcount</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593176490141548543"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593386771740360703"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">                 </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593308294097928191"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593825202001936383"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593163914477305855"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592998781574709247"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593262526926422015"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592370479398911999"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593472602366803967"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w">                                                                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593785619583336447"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"591988330388783103"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592336738135834623"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-10-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_rastertogridcount(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridcount(path, 3)                                                                                   |
+------------------------------------------------------------------------------------------------------------------+
|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1},                 |
|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |
|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1},                   |
|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |
|{"cellID": "593472602366803967", "measure": 3},                                                                   |
|{"cellID": "593785619583336447", "measure": 3}, {"cellID": "591988330388783103", "measure": 1},                   |
|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id3">
<img alt="../_images/h3.png" src="../_images/h3.png"/>
<p class="caption"><span class="caption-text">Fig 2. RST_RasterToGridCount(raster, 3)</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</div>


<h3 id="rst-rastertogridmax">rst_rastertogridmax<a class="headerlink" href="#rst-rastertogridmax" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridmax">
<span class="sig-name descname"><span class="pre">rst_rastertogridmax</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridmax" title="Permalink to this definition">¶</a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the maximum pixel value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-11-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-11-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-11-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-11-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-11-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-11-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_rastertogridmax(path, 3)                                                                                     |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1.2037735849056603},|</span>
<span class="go">|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1.1283185840707965},  |</span>
<span class="go">|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593472602366803967", "measure": 0.3963963963963964},                                                  |</span>
<span class="go">|{"cellID": "593785619583336447", "measure": 0.6590909090909091}, {"cellID": "591988330388783103", "measure": 1},  |</span>
<span class="go">|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridmax</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593176490141548543"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593386771740360703"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593308294097928191"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593825202001936383"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593163914477305855"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592998781574709247"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593262526926422015"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592370479398911999"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593472602366803967"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593785619583336447"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"591988330388783103"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592336738135834623"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-11-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_rastertogridmax(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridmax(path, 3)                                                                                     |
+------------------------------------------------------------------------------------------------------------------+
|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1.2037735849056603},|
|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |
|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1.1283185840707965},  |
|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |
|{"cellID": "593472602366803967", "measure": 0.3963963963963964},                                                  |
|{"cellID": "593785619583336447", "measure": 0.6590909090909091}, {"cellID": "591988330388783103", "measure": 1},  |
|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id4">
<img alt="../_images/h3.png" src="../_images/h3.png"/>
<p class="caption"><span class="caption-text">Fig 3. RST_RasterToGridMax(raster, 3)</span><a class="headerlink" href="#id4" title="Permalink to this image">¶</a></p>
</div>


<h3 id="rst-rastertogridmedian">rst_rastertogridmedian<a class="headerlink" href="#rst-rastertogridmedian" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridmedian">
<span class="sig-name descname"><span class="pre">rst_rastertogridmedian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridmedian" title="Permalink to this definition">¶</a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the median pixel value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-12-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-12-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-12-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-12-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-12-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-12-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_rastertogridmedian(path, 3)                                                                                  |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1.2037735849056603},|</span>
<span class="go">|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1.1283185840707965},  |</span>
<span class="go">|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593472602366803967", "measure": 0.3963963963963964},                                                  |</span>
<span class="go">|{"cellID": "593785619583336447", "measure": 0.6590909090909091}, {"cellID": "591988330388783103", "measure": 1},  |</span>
<span class="go">|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridmedian</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593176490141548543"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593386771740360703"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593308294097928191"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593825202001936383"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593163914477305855"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592998781574709247"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593262526926422015"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592370479398911999"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593472602366803967"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593785619583336447"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"591988330388783103"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592336738135834623"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-12-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_rastertogridmax(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridmedian(path, 3)                                                                                  |
+------------------------------------------------------------------------------------------------------------------+
|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1.2037735849056603},|
|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |
|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1.1283185840707965},  |
|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |
|{"cellID": "593472602366803967", "measure": 0.3963963963963964},                                                  |
|{"cellID": "593785619583336447", "measure": 0.6590909090909091}, {"cellID": "591988330388783103", "measure": 1},  |
|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id5">
<img alt="../_images/h3.png" src="../_images/h3.png"/>
<p class="caption"><span class="caption-text">Fig 4. RST_RasterToGridMedian(raster, 3)</span><a class="headerlink" href="#id5" title="Permalink to this image">¶</a></p>
</div>


<h3 id="rst-rastertogridmin">rst_rastertogridmin<a class="headerlink" href="#rst-rastertogridmin" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertogridmin">
<span class="sig-name descname"><span class="pre">rst_rastertogridmin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertogridmin" title="Permalink to this definition">¶</a></dt>
<dd><p>The result is a 2D array of cells, where each cell is a struct of (cellID, value).
For getting the output of cellID-&gt;value pairs, please use explode() function twice.
CellID can be LongType or StringType depending on the configuration of MosaicContext.
The value/measure for each cell is the median pixel value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>raster</strong> – A resolution of the grid index system.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: ArrayType(ArrayType(StructType(LongType|StringType, DoubleType)))</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-13-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-13-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-13-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-13-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-13-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-13-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_rastertogridmin(path, 3)                                                                                     |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1.2037735849056603},|</span>
<span class="go">|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1.1283185840707965},  |</span>
<span class="go">|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |</span>
<span class="go">|{"cellID": "593472602366803967", "measure": 0.3963963963963964},                                                  |</span>
<span class="go">|{"cellID": "593785619583336447", "measure": 0.6590909090909091}, {"cellID": "591988330388783103", "measure": 1},  |</span>
<span class="go">|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertogridmin</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="p">[[{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593176490141548543"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593386771740360703"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2037735849056603</span><span class="p">},</span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593308294097928191"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593825202001936383"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593163914477305855"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592998781574709247"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">1.1283185840707965</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593262526926422015"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592370479398911999"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">},</span><span class="w">                   </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593472602366803967"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.3963963963963964</span><span class="p">},</span><span class="w">                                                  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"593785619583336447"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mf">0.6590909090909091</span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"591988330388783103"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="p">{</span><span class="s">"cellID"</span><span class="p">:</span><span class="w"> </span><span class="s">"592336738135834623"</span><span class="p">,</span><span class="w"> </span><span class="s">"measure"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">},</span><span class="w"> </span><span class="p">....]]</span><span class="w">                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-13-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_rastertogridmin(path, 3)
+------------------------------------------------------------------------------------------------------------------+
| rst_rastertogridmin(path, 3)                                                                                     |
+------------------------------------------------------------------------------------------------------------------+
|[[{"cellID": "593176490141548543", "measure": 0}, {"cellID": "593386771740360703", "measure": 1.2037735849056603},|
|{"cellID": "593308294097928191", "measure": 0}, {"cellID": "593825202001936383", "measure": 0},                   |
|{"cellID": "593163914477305855", "measure": 2}, {"cellID": "592998781574709247", "measure": 1.1283185840707965},  |
|{"cellID": "593262526926422015", "measure": 2}, {"cellID": "592370479398911999", "measure": 0},                   |
|{"cellID": "593472602366803967", "measure": 0.3963963963963964},                                                  |
|{"cellID": "593785619583336447", "measure": 0.6590909090909091}, {"cellID": "591988330388783103", "measure": 1},  |
|{"cellID": "592336738135834623", "measure": 1}, ....]]                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>
<div class="doc-figure figure align-default" id="id6">
<img alt="../_images/h3.png" src="../_images/h3.png"/>
<p class="caption"><span class="caption-text">Fig 4. RST_RasterToGridMin(raster, 3)</span><a class="headerlink" href="#id6" title="Permalink to this image">¶</a></p>
</div>


<h3 id="rst-rastertoworldcoord">rst_rastertoworldcoord<a class="headerlink" href="#rst-rastertoworldcoord" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertoworldcoord">
<span class="sig-name descname"><span class="pre">rst_rastertoworldcoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertoworldcoord" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the world coordinates of the raster pixel at the given x and y coordinates.
The result is a WKT point geometry.
The coordinates are computed using the GeoTransform of the raster to respect the projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – x coordinate of the pixel.</p></li>
<li><p><strong>y</strong> – y coordinate of the pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-14-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-14-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-14-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-14-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-14-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-14-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_rastertoworldcoord(path, 3, 3)                                                                               |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">|POINT (-179.85000609927647 89.84999847624096)                                                                     |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="nc">POINT</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mf">179.85000609927647</span><span class="w"> </span><span class="mf">89.84999847624096</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-14-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoord</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="n">POINT</span><span class="w"> </span><span class="p">(</span><span class="o">-</span><span class="mi">179</span><span class="p">.</span><span class="mi">85000609927647</span><span class="w"> </span><span class="mi">89</span><span class="p">.</span><span class="mi">84999847624096</span><span class="p">)</span><span class="w">                                                                     </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-rastertoworldcoordx">rst_rastertoworldcoordx<a class="headerlink" href="#rst-rastertoworldcoordx" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">rst_rastertoworldcoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id0" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the world coordinates of the raster pixel at the given x and y coordinates.
The result is the X coordinate of the point after applying the GeoTransform of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – x coordinate of the pixel.</p></li>
<li><p><strong>y</strong> – y coordinate of the pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-15-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-15-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-15-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-15-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-15-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-15-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_rastertoworldcoordx(path, 3, 3)                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| -179.85000609927647                                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">179.85000609927647</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-15-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mi">179</span><span class="p">.</span><span class="mi">85000609927647</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-rastertoworldcoordy">rst_rastertoworldcoordy<a class="headerlink" href="#rst-rastertoworldcoordy" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rastertoworldcoordy">
<span class="sig-name descname"><span class="pre">rst_rastertoworldcoordy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rastertoworldcoordy" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the world coordinates of the raster pixel at the given x and y coordinates.
The result is the X coordinate of the point after applying the GeoTransform of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – x coordinate of the pixel.</p></li>
<li><p><strong>y</strong> – y coordinate of the pixel.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-16-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-16-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-16-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-16-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-16-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-16-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_rastertoworldcoordy(path, 3, 3)                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 89.84999847624096                                                                                                |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">3</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">89.84999847624096</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-16-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rastertoworldcoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w">                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">89</span><span class="p">.</span><span class="mi">84999847624096</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-retile">rst_retile<a class="headerlink" href="#rst-retile" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_retile">
<span class="sig-name descname"><span class="pre">rst_retile</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">height</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_retile" title="Permalink to this definition">¶</a></dt>
<dd><p>Retiles the raster to the given tile size. The result is a collection of new raster files.
The new rasters are stored in the checkpoint directory.
The results are the paths to the new rasters.
The result set is automatically exploded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>width</strong> – The width of the tiles.</p></li>
<li><p><strong>height</strong> – The height of the tiles.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StringType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-17-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-17-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-17-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-17-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-17-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-17-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_retile</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_retile(path, 300, 300)                                                                                       |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| /dbfs/tmp/mosaic/raster/checkpoint/raster_1095576780709022500.tif                                                |</span>
<span class="go">| /dbfs/tmp/mosaic/raster/checkpoint/raster_-1042125519107460588.tif                                               |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_retile</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mi">300</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_retile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span><span class="w">                                                                                       </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_1095576780709022500</span><span class="p">.</span><span class="n">tif</span><span class="w">                                                </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="n">checkpoint</span><span class="o">/</span><span class="n">raster_-</span><span class="mi">1042125519107460588</span><span class="p">.</span><span class="n">tif</span><span class="w">                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-17-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_retile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_retile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="mi">300</span><span class="p">)</span><span class="w">                                                                                       </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="k">checkpoint</span><span class="o">/</span><span class="n">raster_1095576780709022500</span><span class="p">.</span><span class="n">tif</span><span class="w">                                                </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="o">/</span><span class="n">dbfs</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">mosaic</span><span class="o">/</span><span class="n">raster</span><span class="o">/</span><span class="k">checkpoint</span><span class="o">/</span><span class="n">raster_</span><span class="o">-</span><span class="mi">1042125519107460588</span><span class="p">.</span><span class="n">tif</span><span class="w">                                               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-rotation">rst_rotation<a class="headerlink" href="#rst-rotation" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_rotation">
<span class="sig-name descname"><span class="pre">rst_rotation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the rotation of the raster in degrees.
The rotation is the angle between the X axis and the North axis.
The rotation is computed using the GeoTransform of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-18-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-18-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-18-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-18-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-18-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-18-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_rotation</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_rotation(path)                                                                                               |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 1.2                                                                                                              |</span>
<span class="go">| 21.2                                                                                                             |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                               </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mf">21.2</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-18-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_rotation</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                               </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="mi">21</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-scalex">rst_scalex<a class="headerlink" href="#rst-scalex" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_scalex">
<span class="sig-name descname"><span class="pre">rst_scalex</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_scalex" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the scale of the raster in the X direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-19-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-19-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-19-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-19-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-19-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-19-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_scalex</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_scalex(path)                                                                                                 |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 1.2                                                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-19-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scalex</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-scaley">rst_scaley<a class="headerlink" href="#rst-scaley" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_scaley">
<span class="sig-name descname"><span class="pre">rst_scaley</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_scaley" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the scale of the raster in the Y direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-20-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-20-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-20-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-20-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-20-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-20-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_scaley</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_scaley(path)                                                                                                 |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 1.2                                                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-20-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_scaley</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                 </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-skewx">rst_skewx<a class="headerlink" href="#rst-skewx" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_skewx">
<span class="sig-name descname"><span class="pre">rst_skewx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_skewx" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the skew of the raster in the X direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-21-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-21-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-21-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-21-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-21-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-21-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_skewx</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_skewx(path)                                                                                                  |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 1.2                                                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-21-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-skewy">rst_skewy<a class="headerlink" href="#rst-skewy" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">rst_skewx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#id1" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the skew of the raster in the Y direction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-22-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-22-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-22-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-22-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-22-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-22-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_skewy</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_skewy(path)                                                                                                  |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 1.2                                                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">1.2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-22-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_skewy</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">1</span><span class="p">.</span><span class="mi">2</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-srid">rst_srid<a class="headerlink" href="#rst-srid" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_srid">
<span class="sig-name descname"><span class="pre">rst_srid</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_srid" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the SRID of the raster.
The SRID is the EPSG code of the raster.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-23-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-23-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-23-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-23-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-23-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-23-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_srid</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_srid(path)                                                                                                   |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 9122                                                                                                             |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_srid</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_srid</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                   </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">9122</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-23-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_srid</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_srid</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                   </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">9122</span><span class="w">                                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-subdatasets">rst_subdatasets<a class="headerlink" href="#rst-subdatasets" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_subdatasets">
<span class="sig-name descname"><span class="pre">rst_subdatasets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_subdatasets" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the subdatasets of the raster.
The subdatasets are the paths to the subdatasets of the raster.
The result is a map of the subdataset path to the subdatasets and the description of the subdatasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-24-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-24-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-24-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-24-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-24-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-24-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_subdatasets</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_subdatasets(path)                                                                                            |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| {"NETCDF:\"/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_2022010|</span>
<span class="go">|6-1.nc\":bleaching_alert_area": "[1x3600x7200] N/A (8-bit unsigned integer)", "NETCDF:\"/dbfs/FileStore/geospatial|</span>
<span class="go">|/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc\":mask": "[1x3600x7200] mask (8|</span>
<span class="go">|-bit unsigned integer)"}                                                                                          |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_subdatasets</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_subdatasets</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                            </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">"NETCDF:\"/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_2022010|</span>
<span class="s">|6-1.nc\":bleaching_alert_area"</span><span class="p">:</span><span class="w"> </span><span class="s">"[1x3600x7200] N/A (8-bit unsigned integer)"</span><span class="p">,</span><span class="w"> </span><span class="s">"NETCDF:\"/dbfs/FileStore/geospatial|</span>
<span class="s">|/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc\":mask"</span><span class="p">:</span><span class="w"> </span><span class="s">"[1x3600x7200] mask (8|</span>
<span class="s">|-bit unsigned integer)"</span><span class="p">}</span><span class="w">                                                                                          </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-24-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_subdatasets(path)
+------------------------------------------------------------------------------------------------------------------+
| rst_subdatasets(path)                                                                                            |
+------------------------------------------------------------------------------------------------------------------+
| {"NETCDF:\"/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_2022010|
|6-1.nc\":bleaching_alert_area": "[1x3600x7200] N/A (8-bit unsigned integer)", "NETCDF:\"/dbfs/FileStore/geospatial|
|/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc\":mask": "[1x3600x7200] mask (8|
|-bit unsigned integer)"}                                                                                          |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>


<h3 id="rst-summary">rst_summary<a class="headerlink" href="#rst-summary" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_summary">
<span class="sig-name descname"><span class="pre">rst_summary</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the summary of the raster.
The summary is a map of the statistics of the raster.
The logic is produced by gdalinfo procedure.
The result is stored as JSON.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: MapType(StringType, StringType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-25-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-25-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-25-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-25-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-25-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-25-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_summary</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_summary(path)                                                                                                |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| {   "description":"/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1|</span>
<span class="go">|_20220106-1.nc",   "driverShortName":"netCDF",   "driverLongName":"Network Common Data Format",   "files":[       |</span>
<span class="go">|"/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc"    |</span>
<span class="go">|],   "size":[     512,     512   ],   "metadata":{     "":{       "NC_GLOBAL#acknowledgement":"NOAA Coral Reef    |</span>
<span class="go">|Watch Program",       "NC_GLOBAL#cdm_data_type":"Gr...                                                            |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; val df = spark.read
                .format("binaryFile").option("pathGlobFilter", "*.nc")
                .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; df.select(rst_summary(col("path")).show()
+------------------------------------------------------------------------------------------------------------------+
| rst_summary(path)                                                                                                |
+------------------------------------------------------------------------------------------------------------------+
| {   "description":"/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1|
|_20220106-1.nc",   "driverShortName":"netCDF",   "driverLongName":"Network Common Data Format",   "files":[       |
|"/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc"    |
|],   "size":[     512,     512   ],   "metadata":{     "":{       "NC_GLOBAL#acknowledgement":"NOAA Coral Reef    |
|Watch Program",       "NC_GLOBAL#cdm_data_type":"Gr...                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div><div aria-labelledby="tab-25-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-25-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_summary(path)
+------------------------------------------------------------------------------------------------------------------+
| rst_summary(path)                                                                                                |
+------------------------------------------------------------------------------------------------------------------+
| {   "description":"/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1|
|_20220106-1.nc",   "driverShortName":"netCDF",   "driverLongName":"Network Common Data Format",   "files":[       |
|"/dbfs/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral/ct5km_baa_max_7d_v3_1_20220106-1.nc"    |
|],   "size":[     512,     512   ],   "metadata":{     "":{       "NC_GLOBAL#acknowledgement":"NOAA Coral Reef    |
|Watch Program",       "NC_GLOBAL#cdm_data_type":"Gr...                                                            |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>


<h3 id="rst-upperleftx">rst_upperleftx<a class="headerlink" href="#rst-upperleftx" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_upperleftx">
<span class="sig-name descname"><span class="pre">rst_upperleftx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_upperleftx" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the upper left X coordinate of the raster.
The value is computed based on GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-26-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-26-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-26-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-26-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-26-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-26-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_upperleftx(path)                                                                                             |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| -180.00000610436345                                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mf">180.00000610436345</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-26-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperleftx</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="o">-</span><span class="mi">180</span><span class="p">.</span><span class="mi">00000610436345</span><span class="w">                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-upperlefty">rst_upperlefty<a class="headerlink" href="#rst-upperlefty" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_upperlefty">
<span class="sig-name descname"><span class="pre">rst_upperlefty</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_upperlefty" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the upper left Y coordinate of the raster.
The value is computed based on GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: DoubleType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-27-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-27-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-27-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-27-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-27-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-27-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_upperlefty(path)                                                                                             |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 89.99999847369712                                                                                                |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mf">89.99999847369712</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-27-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-27-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_upperlefty</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">89</span><span class="p">.</span><span class="mi">99999847369712</span><span class="w">                                                                                                </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-width">rst_width<a class="headerlink" href="#rst-width" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_width">
<span class="sig-name descname"><span class="pre">rst_width</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_width" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the width of the raster in pixels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>raster</strong> – A column containing the path to a raster file.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-28-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-28-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-28-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-28-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-28-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-28-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_width</span><span class="p">(</span><span class="s1">'path'</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_width(path)                                                                                                  |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 600                                                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_width</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_width</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">600</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-28-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-28-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_width</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_width</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                                  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">600</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-worldtorastercoord">rst_worldtorastercoord<a class="headerlink" href="#rst-worldtorastercoord" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_worldtorastercoord">
<span class="sig-name descname"><span class="pre">rst_worldtorastercoord</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xworld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yworld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_worldtorastercoord" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the raster coordinates of the world coordinates.
The raster coordinates are the pixel coordinates of the raster.
The world coordinates are the coordinates in the CRS of the raster.
The coordinates are resolved using GeoTransform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – X world coordinate.</p></li>
<li><p><strong>y</strong> – Y world coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: StructType(IntegerType, IntegerType)</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-29-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-29-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-29-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-29-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-29-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-29-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_worldtorastercoord(path)                                                                                     |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| {"x": 398, "y": 997}                                                                                             |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="n">path</span><span class="p">)</span><span class="w">                                                                                     </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="p">{</span><span class="s">"x"</span><span class="p">:</span><span class="w"> </span><span class="mi">398</span><span class="p">,</span><span class="w"> </span><span class="s">"y"</span><span class="p">:</span><span class="w"> </span><span class="mi">997</span><span class="p">}</span><span class="w">                                                                                             </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-29-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-29-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span>&gt;&gt;&gt; CREATE TABLE IF NOT EXISTS TABLE coral_netcdf
    USING binaryFile
    OPTIONS (pathGlobFilter "*.nc", path "dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")
&gt;&gt;&gt; SELECT rst_worldtorastercoord(path, -160.1, 40.0)
+------------------------------------------------------------------------------------------------------------------+
| rst_worldtorastercoord(path)                                                                                     |
+------------------------------------------------------------------------------------------------------------------+
| {"x": 398, "y": 997}                                                                                             |
+------------------------------------------------------------------------------------------------------------------+
</pre></div>
</div>
</div></div>


<h3 id="rst-worldtorastercoordx">rst_worldtorastercoordx<a class="headerlink" href="#rst-worldtorastercoordx" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_worldtorastercoordx">
<span class="sig-name descname"><span class="pre">rst_worldtorastercoordx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xworld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yworld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_worldtorastercoordx" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the raster coordinates of the world coordinates.
The raster coordinates are the pixel coordinates of the raster.
The world coordinates are the coordinates in the CRS of the raster.
The coordinates are resolved using GeoTransform.
This method returns the X coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – X world coordinate.</p></li>
<li><p><strong>y</strong> – Y world coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-30-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-30-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-30-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-30-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-30-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-30-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_worldtorastercoord</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_worldtorastercoordx(path, -160.1, 40.0)                                                                      |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 398                                                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">160.1</span><span class="p">,</span><span class="w"> </span><span class="mf">40.0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">398</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-30-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-30-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordx</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">398</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>


<h3 id="rst-worldtorastercoordy">rst_worldtorastercoordy<a class="headerlink" href="#rst-worldtorastercoordy" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt class="sig sig-object py" id="rst_worldtorastercoordy">
<span class="sig-name descname"><span class="pre">rst_worldtorastercoordy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">raster</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xworld</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yworld</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#rst_worldtorastercoordy" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the raster coordinates of the world coordinates.
The raster coordinates are the pixel coordinates of the raster.
The world coordinates are the coordinates in the CRS of the raster.
The coordinates are resolved using GeoTransform.
This method returns the Y coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>raster</strong> – A column containing the path to a raster file.</p></li>
<li><p><strong>x</strong> – X world coordinate.</p></li>
<li><p><strong>y</strong> – Y world coordinate.</p></li>
</ul>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Column: IntegerType</p>
</dd>
<dt class="field-odd">Example</dt>
<dd class="field-odd"><p></p></dd>
</dl>
</dd></dl>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" role="tablist"><button aria-controls="panel-31-UHl0aG9u" aria-selected="true" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-UHl0aG9u" name="UHl0aG9u" role="tab" tabindex="0">Python</button><button aria-controls="panel-31-U2NhbGE=" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-U2NhbGE=" name="U2NhbGE=" role="tab" tabindex="-1">Scala</button><button aria-controls="panel-31-U1FM" aria-selected="false" class="sphinx-tabs-tab code-tab group-tab" id="tab-31-U1FM" name="U1FM" role="tab" tabindex="-1">SQL</button></div><div aria-labelledby="tab-31-UHl0aG9u" class="sphinx-tabs-panel code-tab group-tab" id="panel-31-UHl0aG9u" name="UHl0aG9u" role="tabpanel" tabindex="0"><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">spark</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">"binaryFile"</span><span class="p">)</span><span class="o">.</span><span class="n">option</span><span class="p">(</span><span class="s2">"pathGlobFilter"</span><span class="p">,</span> <span class="s2">"*.nc"</span><span class="p">)</span> \
<span class="go">                    .load("dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral")</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">mos</span><span class="o">.</span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="s1">'path'</span><span class="p">,</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span> <span class="n">F</span><span class="o">.</span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">))</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| rst_worldtorastercoordy(path, -160.1, 40.0)                                                                      |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="go">| 997                                                                                                              |</span>
<span class="go">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-U2NhbGE=" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-U2NhbGE=" name="U2NhbGE=" role="tabpanel" tabindex="0"><div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="kd">val</span><span class="w"> </span><span class="n">df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spark</span><span class="p">.</span><span class="n">read</span>
<span class="w">                </span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="s">"binaryFile"</span><span class="p">).</span><span class="n">option</span><span class="p">(</span><span class="s">"pathGlobFilter"</span><span class="p">,</span><span class="w"> </span><span class="s">"*.nc"</span><span class="p">)</span>
<span class="w">                </span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="s">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="n">df</span><span class="p">.</span><span class="n">select</span><span class="p">(</span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">col</span><span class="p">(</span><span class="s">"path"</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="o">-</span><span class="mf">160.1</span><span class="p">),</span><span class="w"> </span><span class="n">lit</span><span class="p">(</span><span class="mf">40.0</span><span class="p">)).</span><span class="n">show</span><span class="p">()</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mf">160.1</span><span class="p">,</span><span class="w"> </span><span class="mf">40.0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">997</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-31-U1FM" class="sphinx-tabs-panel code-tab group-tab" hidden="true" id="panel-31-U1FM" name="U1FM" role="tabpanel" tabindex="0"><div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="k">IF</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">EXISTS</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">coral_netcdf</span>
<span class="w">    </span><span class="k">USING</span><span class="w"> </span><span class="n">binaryFile</span>
<span class="w">    </span><span class="k">OPTIONS</span><span class="w"> </span><span class="p">(</span><span class="n">pathGlobFilter</span><span class="w"> </span><span class="ss">"*.nc"</span><span class="p">,</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="ss">"dbfs:/FileStore/geospatial/mosaic/sample_raster_data/binary/netcdf-coral"</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span><span class="w"> </span><span class="k">SELECT</span><span class="w"> </span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">rst_worldtorastercoordy</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">160</span><span class="p">.</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="w">                                                                      </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="mi">997</span><span class="w">                                                                                                              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------------------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</div></div>





          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="spatial-aggregations.html" title="Spatial aggregation functions"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Spatial aggregation functions </span>
              </div>
            </a>
          
          
            <a href="../usage/usage.html" title="Usage"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Usage </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2022, Databricks Inc.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>